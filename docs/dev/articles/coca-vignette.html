<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to coca • coca</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Introduction to coca">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coca</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development package">0.0.1.9005</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/coca-vignette.html">Introduction to coca</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/acabassi/coca">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to coca</h1>
                        <h4 class="author">Alessandra Cabassi</h4>
            
            <h4 class="date">2018-10-25</h4>
      
      <small class="dont-index">Source: <a href="http://github.com/acabassi/coca/blob/master/vignettes/coca-vignette.Rmd"><code>vignettes/coca-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>coca-vignette.Rmd</code></div>

    </div>

    
    
<section id="introduction" class="level1"><h1>Introduction</h1>
<p>The R package <strong>coca</strong> contains the functions needed to use COCA (<strong>C</strong>luster-<strong>O</strong>f-<strong>C</strong>lusters <strong>A</strong>nalysis), an integrative clustering method that was first introduced in a breast cancer study by The Cancer Genome Atlas in 2012 and quickly became a popular tool in cancer studies (see e.g. Hoadley et al. 2014 and Aure et al. 2017). It is based on  (Monti et al., 2013), an algorithm that was initially developed to assess the stability of clusters obtained with any clustering algorithm.</p>
<p>The main goal of COCA is to summarise clusterings found in different ’omics datasets, by identifying a “global” clustering across the datasets that is intended to be in good agreement with the clustering structures identified in each of the individual datasets.</p>
</section><section id="building-the-matrix-of-clusters" class="level1"><h1>Building the matrix of clusters</h1>
<p>The first step of COCA is the construction of the Matrix-Of-Clusters (MOC). This is a binary matrix of size <em>N x K</em>, where <em>K</em> is the sum of the number of clusters <em>Km</em> in every dataset <em>Xm</em>. Therefore, to each column <em>j</em> of this matrix corresponds a cluster <em>mk</em> in dataset <em>Xm</em>. The <em>(i,j)</em>-th entry of the matrix of clusters is equal to one if data point <em>i</em> belongs to cluster <em>mk</em> in dataset <em>Xm</em>, and is equal to zero otherwise.For more details about how the matrix of clusters is built, please see Cabassi and Kirk (2018).</p>
<p>The function that can be used to build a matrix of clusters starting from a list of heterogeneous datasets (referring to the same observations) is <code>buildMOC</code>. In the example below, we assume to have three datasets with the same number of clusters, six. The clustering structure in each of those dataasets is found via k-means clustering.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">### Load data</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">data &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">data[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">read.csv</span>(<span class="kw">system.file</span>(<span class="st">"extdata"</span>, </a>
<a class="sourceLine" id="cb1-4" data-line-number="4">                      <span class="st">"dataset1.csv"</span>, <span class="dt">package =</span> <span class="st">"coca"</span>), <span class="dt">row.names =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">data[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">read.csv</span>(<span class="kw">system.file</span>(<span class="st">"extdata"</span>, </a>
<a class="sourceLine" id="cb1-6" data-line-number="6">                      <span class="st">"dataset2.csv"</span>, <span class="dt">package =</span> <span class="st">"coca"</span>), <span class="dt">row.names =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">data[[<span class="dv">3</span>]] &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">read.csv</span>(<span class="kw">system.file</span>(<span class="st">"extdata"</span>, </a>
<a class="sourceLine" id="cb1-8" data-line-number="8">                      <span class="st">"dataset3.csv"</span>, <span class="dt">package =</span> <span class="st">"coca"</span>), <span class="dt">row.names =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">### Build matrix of clusters</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">outputBuildMOC &lt;-<span class="st"> </span><span class="kw"><a href="../reference/buildMOC.html">buildMOC</a></span>(data, <span class="dt">M =</span> <span class="dv">3</span>, <span class="dt">K =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">### Extract matrix of clusters and dataset indicator vector</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14">moc &lt;-<span class="st"> </span>outputBuildMOC<span class="op">$</span>moc</a>
<a class="sourceLine" id="cb1-15" data-line-number="15">datasetIndicator &lt;-<span class="st"> </span>outputBuildMOC<span class="op">$</span>datasetIndicator</a></code></pre></div>
<p>The package also contains a function that can be used to plot the resulting Matrix-Of-Clusters, <code>plotMOC</code>. Here we use as annotations the true cluster labels, but in real applications annotations can be any dataframe with one element for each row of the matrix of clusters (the row names must correspond!). Please be aware that each column of the dataframe that contains categorical variables must be defined with <code>as.factor()</code> if you want each category to have a different colour (otherwise they will be treaded as continuous variables and each category will have a different shade of the same colour).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">### Prepare annotations</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">true_labels &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">read.csv</span>(<span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"cluster_labels.csv"</span>,</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">                <span class="dt">package =</span> <span class="st">"coca"</span>), <span class="dt">row.names =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">annotations &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">true_labels =</span> <span class="kw">as.factor</span>(true_labels))</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">### Plot matrix of clusters</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw"><a href="../reference/plotMOC.html">plotMOC</a></span>(moc, datasetIndicator, <span class="dt">annotations =</span> annotations)</a></code></pre></div>
<p><img src="../docs/dev/articles/coca-vignette_files/figure-html/plot_moc-1.png" width="700"></p>
<p>Here the datasets don’t have names, so they have been assigned integer numbers. If available, you can specify cluster names; this will make the row names easier to interpret.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co">### Prepare annotations</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">true_labels &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">read.csv</span>(<span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"cluster_labels.csv"</span>,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">                <span class="dt">package =</span> <span class="st">"coca"</span>), <span class="dt">row.names =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">annotations &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">true_labels =</span> <span class="kw">as.factor</span>(true_labels))</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">### Set dataset names </span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">datasetNames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">"A"</span>, <span class="dv">6</span>), <span class="kw">rep</span>(<span class="st">"B"</span>, <span class="dv">6</span>), <span class="kw">rep</span>(<span class="st">"C"</span>, <span class="dv">6</span>))</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">### Plot matrix of clusters</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="kw"><a href="../reference/plotMOC.html">plotMOC</a></span>(moc, datasetIndicator, <span class="dt">datasetNames =</span> datasetNames, </a>
<a class="sourceLine" id="cb3-11" data-line-number="11">        <span class="dt">annotations =</span> annotations)</a></code></pre></div>
<p><img src="../docs/dev/articles/coca-vignette_files/figure-html/plot_moc_with_names-1.png" width="700"></p>
<p>As you can see, the first part of each row name corresponds to the dataset, the second one to the cluster index. Moreover, each colour in the main matrix corresponds to one dataset (here dataset A is green, dataset B is yellow, and so on).</p>
</section><section id="cluster-of-clusters-analysis" class="level1"><h1>Cluster-Of-Clusters Analysis</h1>
<p>The MOC matrix is then used as input to consensus clustering (CC), an algorithm that was developed by Monti et al. (2003) to assess cluster stability when analysing a single dataset. The resulting consensus matrix is then used as the similarity matrix for a hierarchical clustering method (or any other distance-based clustering algorithm). These last two steps of the COCA algorithm are contained in the <code><a href="../reference/coca.html">coca()</a></code> function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">### COCA</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co"># Use COCA to find global clustering</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">coca &lt;-<span class="st"> </span><span class="kw"><a href="../reference/coca.html">coca</a></span>(moc, <span class="dt">K =</span> <span class="dv">6</span>, <span class="dt">hclustMethod =</span> <span class="st">"average"</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co"># Compare clustering to the true labels</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">ari &lt;-<span class="st"> </span>mclust<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/mclust/topics/adjustedRandIndex">adjustedRandIndex</a></span>(true_labels, coca<span class="op">$</span>clusterLabels)</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">ari</a></code></pre></div>
<pre><code>## [1] 0.8163432</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">### Plot the matrix of clusters with the newly found cluster labels</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">annotations<span class="op">$</span>coca &lt;-<span class="st"> </span><span class="kw">as.factor</span>(coca<span class="op">$</span>clusterLabels)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw"><a href="../reference/plotMOC.html">plotMOC</a></span>(moc, datasetIndicator, <span class="dt">datasetNames =</span> datasetNames, </a>
<a class="sourceLine" id="cb6-4" data-line-number="4">        <span class="dt">annotations =</span> annotations)</a></code></pre></div>
<p><img src="../docs/dev/articles/coca-vignette_files/figure-html/coca-1.png" width="700"></p>
<p>Again, if the number of clusters is not know a priori, the user can delegate the choice of K to the <code><a href="../reference/coca.html">coca()</a></code> function. There are two methods available here: the silhouette, where the distance between data points <em>i</em> and <em>j</em> is defined as <em>1</em> minus the <em>(i,j)</em>-th kernel entry in the final kernel matrix, and the delta area under the curve, which is the method suggested by Monti et al. (2003). Please note that the properties of the latter have not been assessed yet.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Use COCA to find global clustering and chooose the number of clusters</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">coca &lt;-<span class="st"> </span><span class="kw"><a href="../reference/coca.html">coca</a></span>(moc, <span class="dt">maxK =</span> <span class="dv">10</span>, <span class="dt">hclustMethod =</span> <span class="st">"average"</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co"># Compare clustering to the true labels</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">ari &lt;-<span class="st"> </span>mclust<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/mclust/topics/adjustedRandIndex">adjustedRandIndex</a></span>(true_labels, coca<span class="op">$</span>clusterLabels)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">ari</a></code></pre></div>
<pre><code>## [1] 0.8163432</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co">### Plot the matrix of clusters with the newly found cluster labels</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">annotations<span class="op">$</span>coca &lt;-<span class="st"> </span><span class="kw">as.factor</span>(coca<span class="op">$</span>clusterLabels)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw"><a href="../reference/plotMOC.html">plotMOC</a></span>(moc, datasetIndicator, <span class="dt">datasetNames =</span> datasetNames, </a>
<a class="sourceLine" id="cb9-4" data-line-number="4">        <span class="dt">annotations =</span> annotations)</a></code></pre></div>
<p><img src="../docs/dev/articles/coca-vignette_files/figure-html/coca_unknownK-1.png" width="700"></p>
</section><section id="references" class="level1"><h1>References</h1>
<p>Aure, M.R., Vitelli, V., Jernström, S., Kumar, S., Krohn, M., Due, E.U., Haukaas, T.H., Leivonen, S.K., Vollan, H.K.M., Lüders, T. and Rødland, E. (2017). Integrative clustering reveals a novel split in the luminal A subtype of breast cancer with impact on outcome. Breast Cancer Research, 19(1), p.44.</p>
<p>Cabassi, A. and Kirk, P. D. W. (2018). Multiple kernel learning for integrative consensus clustering. In preparation.</p>
<p>Hoadley, K.A., Yau, C., Wolf, D.M., Cherniack, A.D., Tamborero, D., Ng, S., Leiserson, M.D., Niu, B., McLellan, M.D., Uzunangelov, V. and Zhang, J., 2014. Multiplatform analysis of 12 cancer types reveals molecular classification within and across tissues of origin. Cell, 158(4), pp.929-944.</p>
<p>Monti, S. et al. (2003). Consensus Clustering: A Resampling-Based Method for Class Discovery and Visualization of Gene. Machine Learning, 52(i), 91–118.</p>
<p>The Cancer Genome Atlas (2012). Comprehensive molecular portraits of human breast tumours. Nature, 487(7407), 61–70.</p>
</section>
</div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#building-the-matrix-of-clusters">Building the matrix of clusters</a></li>
      <li><a href="#cluster-of-clusters-analysis">Cluster-Of-Clusters Analysis</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://alessandracabassi.wordpress.com">Alessandra Cabassi</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script>
  docsearch({
    
    
    apiKey: 'API_KEY',
    indexName: 'INDEX_NAME',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
