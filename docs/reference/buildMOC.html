<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Build Matrix-Of-Clusters — buildMOC • coca</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Build Matrix-Of-Clusters — buildMOC" />

<meta property="og:description" content="This function creates a matrix of clusters starting from a list of heterogeneous datasets." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-128138627-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-128138627-3');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coca</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">
    <span class="fa fa-play-circle"></span>
     
    Vignettes
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-pencil"></span>
     
    Documentation
  </a>
</li>
<li>
  <a href="https://github.com/acabassi/coca">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/acabassi/coca">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Build Matrix-Of-Clusters</h1>
    <small class="dont-index">Source: <a href='https://github.com/acabassi/coca/blob/master/R/build-moc.R'><code>R/build-moc.R</code></a></small>
    <div class="hidden name"><code>buildMOC.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function creates a matrix of clusters starting from a list of heterogeneous datasets.</p>
    
    </div>

    <pre class="usage"><span class='fu'>buildMOC</span>(<span class='no'>data</span>, <span class='no'>M</span>, <span class='kw'>K</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>maxK</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>methods</span> <span class='kw'>=</span> <span class='st'>"hclust"</span>,
  <span class='kw'>distances</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>fill</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>computeAccuracy</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>fullData</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>savePNG</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>widestGap</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>dunns</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>dunn2s</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>List of M datasets, each of size N X P_m, where m = 1, ..., M.</p></td>
    </tr>
    <tr>
      <th>M</th>
      <td><p>Number of datasets.</p></td>
    </tr>
    <tr>
      <th>K</th>
      <td><p>Vector containing the number of clusters in each dataset. If given an integer
instead of a vector it is assumed that each dataset has the same number of clusters.
If NULL, it is assumed that the true cluster numbers are not known, therefore they will be
estimated using the silhouette method.</p></td>
    </tr>
    <tr>
      <th>maxK</th>
      <td><p>Vector of maximum cluster numbers to be considered for each dataset
if K is NULL. If given an integer instead of a vector it is assumed that for each dataset
the same maximum number of clusters must be considered. Default is 10.</p></td>
    </tr>
    <tr>
      <th>methods</th>
      <td><p>Vector of strings containing the names of the clustering methods to be
used to cluster the observations in each dataset. Each can be "kmeans", "hclust", or "pam".
If the vector is of length one, the same clustering method is applied to all the datasets.</p></td>
    </tr>
    <tr>
      <th>distances</th>
      <td><p>Distances to be used in the clustering step for each dataset. At the moment
there is only the option to choose "cor" for 1-correlation. Otherwise the default distance
for each method is used.</p></td>
    </tr>
    <tr>
      <th>fill</th>
      <td><p>Boolean. If TRUE, if there are any missing observations in one or more datasets,
the corresponding cluster labels will be estimated through generalised linear models on the
basis of the available labels.</p></td>
    </tr>
    <tr>
      <th>computeAccuracy</th>
      <td><p>Boolean. If TRUE, for each missing element, the performance of the
predictive model used to estimate the corresponding missing label is computer.</p></td>
    </tr>
    <tr>
      <th>fullData</th>
      <td><p>Boolean. If TRUE, the full data matrices are used to estimate the missing
cluster labels (instead of just using the cluster labels of the corresponding datasets).</p></td>
    </tr>
    <tr>
      <th>savePNG</th>
      <td><p>Boolean. If TRUE, plots of the silhouette for each datasets are saved as
png files.</p></td>
    </tr>
    <tr>
      <th>widestGap</th>
      <td><p>Boolean. If TRUE, compute also widest gap index to choose best number
of clusters. Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>dunns</th>
      <td><p>Boolean. If TRUE, compute also Dunn's index to choose best number
of clusters. Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>dunn2s</th>
      <td><p>Boolean. If TRUE, compute also alternative Dunn's index to choose best number
of clusters. Default is FALSE.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The output is a list containing:
* The Matrix-Of-Clusters `moc`, a binary matrix of size `N x sum(K)`
where element `(n,k)` contains a 1 if observation n belongs to the corresponding cluster,
0 otherwise.
* A vector called `datasetIndicator` of length `sum(K)` in which
each element is the number of the dataset to which the cluster belongs.
* `number_nas`, the total number of NAs in the matrix of clusters. (If the MOC has been
filled with imputed values, `number_nas` indicated the number of NAs in the original MOC.)
* `clLabels`, a matrix that is equivalent to the matrix of clusters, but is in compact form,
i.e. each column corresponds to a dataset, each row represents an observation,
 and its values indicate the cluster labels.
* `K`, vector of cluster numbers in each dataset. If these are provided as input,
this is the same as the input (expanded to a vector if the input is an integer). If the
cluster numbers are not provided as input, this vector contains the cluster numbers
chosen via silhouette for each dataset.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>The Cancer Genome Atlas, 2012. Comprehensive molecular portraits of human
breast tumours. Nature, 487(7407), pp.61–70.</p>
<p>Rousseeuw, P.J., 1987. Silhouettes: a graphical aid to the interpretation and validation
of cluster analysis. Journal of computational and applied mathematics, 20, pp.53-65.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Load data</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>()
<span class='no'>data</span><span class='kw'>[[</span><span class='fl'>1</span>]] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>as.matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/read.table'>read.csv</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"dataset1.csv"</span>,
<span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"coca"</span>), <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='fl'>1</span>))
<span class='no'>data</span><span class='kw'>[[</span><span class='fl'>2</span>]] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>as.matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/read.table'>read.csv</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"dataset2.csv"</span>,
<span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"coca"</span>), <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='fl'>1</span>))
<span class='no'>data</span><span class='kw'>[[</span><span class='fl'>3</span>]] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>as.matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/read.table'>read.csv</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"dataset3.csv"</span>,
<span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"coca"</span>), <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='fl'>1</span>))

<span class='co'>## Build matrix of clusters</span>
<span class='no'>outputBuildMOC</span> <span class='kw'>&lt;-</span> <span class='fu'>buildMOC</span>(<span class='no'>data</span>, <span class='kw'>M</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>K</span> <span class='kw'>=</span> <span class='fl'>6</span>, <span class='kw'>distances</span> <span class='kw'>=</span> <span class='st'>"cor"</span>)

<span class='co'>## Extract matrix of clusters</span>
<span class='no'>matrixOfClusters</span> <span class='kw'>&lt;-</span> <span class='no'>outputBuildMOC</span>$<span class='no'>moc</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Alessandra Cabassi <a href='mailto:ac2051@cam.ac.uk'>ac2051@cam.ac.uk</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://alessandracabassi.wordpress.com'>Alessandra Cabassi</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

