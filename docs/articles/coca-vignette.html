<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to coca • coca</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to coca">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coca</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.1.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/coca-vignette.html">Introduction to coca</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/acabassi/klic">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to coca</h1>
                        <h4 class="author">Alessandra Cabassi</h4>
            
            <h4 class="date">2018-10-15</h4>
      
      <small class="dont-index">Source: <a href="http://github.com/acabassi/klic/blob/master/vignettes/coca-vignette.Rmd"><code>vignettes/coca-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>coca-vignette.Rmd</code></div>

    </div>

    
    
<section id="introduction" class="level1"><h1>Introduction</h1>
<p>The R package <strong>coca</strong> contains the functions needed to use COCA (<strong>C</strong>luster-<strong>O</strong>f-<strong>C</strong>lusters <strong>A</strong>nalysis), an integrative clustering method that was first introduced in a breast cancer study by The Cancer Genome Atlas in 2012 and quickly became a popular tool in cancer studies (see e.g. Hoadley et al. 2014 and Aure et al. 2017). It is based on  (Monti et al., 2013), an algorithm that was initially developed to assess the stability of the clusters obtained with any clustering algorithm.</p>
</section><section id="building-the-matrix-of-clusters" class="level1"><h1>Building the matrix of clusters</h1>
<p>The main goal of COCA is to summarise the clusterings found in different ’omics datasets, by identifying a “global” clustering across the datasets that is intended to be in good agreement with the clustering structures identified in each of the individual datasets.</p>
<p>The first step of COCA is the construction of the Matrix-Of-Clusters (MOC). This is a binary matrix of size <em>N x K</em>, where <em>K</em> is the sum of the number of clusters <em>Km</em> in every dataset <em>Xm</em>. Therefore, to each column <em>j</em> of this matrix corresponds a cluster <em>mk</em> in dataset <em>Xm</em>. The <em>(i,j)</em>-th entry of the matrix of clusters is equal to one if data point <em>i</em> belongs to cluster <em>mk</em> in dataset <em>Xm</em>, and is equal to zero otherwise.For more details about how the matrix of clusters is built, please see Cabassi and Kirk (2018).</p>
<p>In the example below, we assume to have three datasets with the same number of clusters, six. The clustering structure in each of those dataasets is found via k-means clustering. The resulting clusters are stored in three matrices of cluster labels, that are then collated together to get a matrix of clusters.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">### Load data</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">data &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">data[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">read.csv</span>(<span class="kw">system.file</span>(<span class="st">"extdata"</span>, </a>
<a class="sourceLine" id="cb1-4" data-line-number="4">                      <span class="st">"dataset1.csv"</span>, <span class="dt">package =</span> <span class="st">"coca"</span>), <span class="dt">row.names =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">data[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">read.csv</span>(<span class="kw">system.file</span>(<span class="st">"extdata"</span>, </a>
<a class="sourceLine" id="cb1-6" data-line-number="6">                      <span class="st">"dataset2.csv"</span>, <span class="dt">package =</span> <span class="st">"coca"</span>), <span class="dt">row.names =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">data[[<span class="dv">3</span>]] &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">read.csv</span>(<span class="kw">system.file</span>(<span class="st">"extdata"</span>, </a>
<a class="sourceLine" id="cb1-8" data-line-number="8">                      <span class="st">"dataset3.csv"</span>, <span class="dt">package =</span> <span class="st">"coca"</span>), <span class="dt">row.names =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">### Set constants</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">n_datasets &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">n_clusters &lt;-<span class="st"> </span><span class="dv">6</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13">N &lt;-<span class="st"> </span><span class="dv">300</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14">true_labels &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">read.csv</span>(<span class="kw">system.file</span>(<span class="st">"extdata"</span>,</a>
<a class="sourceLine" id="cb1-15" data-line-number="15">                         <span class="st">"cluster_labels.csv"</span>, <span class="dt">package =</span> <span class="st">"coca"</span>), <span class="dt">row.names =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">### Fill label matrix with clusterings found with the k-means clustering algorithm</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18">labelMatrix &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="kw">c</span>(n_clusters, N, n_datasets))</a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_datasets){</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">  output &lt;-<span class="st"> </span><span class="kw">kmeans</span>(data[[i]], n_clusters)</a>
<a class="sourceLine" id="cb1-21" data-line-number="21">  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_clusters){</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">    labelMatrix[k,,i] &lt;-<span class="st"> </span>(output<span class="op">$</span>cluster<span class="op">==</span>k)</a>
<a class="sourceLine" id="cb1-23" data-line-number="23">  }</a>
<a class="sourceLine" id="cb1-24" data-line-number="24">}</a>
<a class="sourceLine" id="cb1-25" data-line-number="25"></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="co"># Convert label matrix from logic to numeric matrix</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27">labelMatrix &lt;-<span class="st"> </span>labelMatrix<span class="op">*</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co"># Build MOC matrix</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30">MOC &lt;-<span class="st"> </span><span class="kw">rbind</span>(labelMatrix[,,<span class="dv">1</span>],labelMatrix[,,<span class="dv">2</span>], labelMatrix[,,<span class="dv">3</span>])</a></code></pre></div>
</section><section id="cluster-of-clusters-analysis" class="level1"><h1>Cluster-Of-Clusters Analysis</h1>
<p>The MOC matrix is then used as input to consensus clustering (CC), an algotithm that was developed by Monti et al. (2003) to assess cluster stability when analysing a single dataset. The resulting consensus matrix is then used as the similarity matrix for a hierarchical clustering method (or any other distance-based clustering algorithm). These last two steps of the COCA algorithm are contained in the <code><a href="../reference/coca.html">coca()</a></code> function.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">### COCA</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co"># Use COCA to find global clustering</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">coca &lt;-<span class="st"> </span><span class="kw"><a href="../reference/coca.html">coca</a></span>(<span class="kw">t</span>(MOC), <span class="dt">K =</span> <span class="dv">6</span>, <span class="dt">hclustMethod =</span> <span class="st">"average"</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co"># Compare clustering to the true labels</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">ari &lt;-<span class="st"> </span>mclust<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/mclust/topics/adjustedRandIndex">adjustedRandIndex</a></span>(true_labels, coca<span class="op">$</span>clusterLabels)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">ari</a></code></pre></div>
<pre><code>## [1] 0.8760337</code></pre>
</section><section id="references" class="level1"><h1>References</h1>
<p>Aure, M.R., Vitelli, V., Jernström, S., Kumar, S., Krohn, M., Due, E.U., Haukaas, T.H., Leivonen, S.K., Vollan, H.K.M., Lüders, T. and Rødland, E. (2017). Integrative clustering reveals a novel split in the luminal A subtype of breast cancer with impact on outcome. Breast Cancer Research, 19(1), p.44.</p>
<p>Cabassi, A. and Kirk, P. D. W. (2018). Multiple kernel learning for integrative consensus clustering. In preparation.</p>
<p>Hoadley, K.A., Yau, C., Wolf, D.M., Cherniack, A.D., Tamborero, D., Ng, S., Leiserson, M.D., Niu, B., McLellan, M.D., Uzunangelov, V. and Zhang, J., 2014. Multiplatform analysis of 12 cancer types reveals molecular classification within and across tissues of origin. Cell, 158(4), pp.929-944.</p>
<p>Monti, S. et al. (2003). Consensus Clustering: A Resampling-Based Method for Class Discovery and Visualization of Gene. Machine Learning, 52(i), 91–118.</p>
<p>The Cancer Genome Atlas (2012). Comprehensive molecular portraits of human breast tumours. Nature, 487(7407), 61–70.</p>
</section>
</div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#building-the-matrix-of-clusters">Building the matrix of clusters</a></li>
      <li><a href="#cluster-of-clusters-analysis">Cluster-Of-Clusters Analysis</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Alessandra Cabassi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
